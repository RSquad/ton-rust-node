## @section General parameters

## @param replicas Number of nodectl instances. Each replica shares the same PVC — do not scale beyond 1 unless using ReadWriteMany storage.
##
replicas: 1

## @section Image parameters

## @param image.repository Container image repository
## @param image.tag Image tag
## @param image.pullPolicy Pull policy
##
image:
  repository: ghcr.io/rsquad/ton-rust-node/nodectl
  tag: "v0.1.0"
  pullPolicy: IfNotPresent

## @param imagePullSecrets [array] Registry pull secrets for private container images
##
imagePullSecrets: []

## @section Container parameters

## @param logLevel Logging level: trace, debug, info, warn, error
##
logLevel: info

## @param logFile [nullable] Path to log file inside the container. Null means stdout only.
##
logFile: null

## @section Port parameters

## @param port HTTP API port. Used for health probes, REST API, and Swagger UI.
##
port: 8080

## @section Service parameters

## @param service.type Service type for the HTTP API
## @param service.annotations [object] Annotations for the Service
##
service:
  type: ClusterIP
  annotations: {}

## @section Storage parameters
## nodectl data directory is a PVC. Config, file vault, and runtime state all live here.

## @param storage.size PVC size for nodectl data
## @param storage.storageClassName [nullable] Storage class name. Empty string uses cluster default.
## @param storage.accessMode PVC access mode
## @param storage.resourcePolicy Value for the `helm.sh/resource-policy` annotation. Set to `keep` (default) to prevent PVC deletion on `helm uninstall`. Set to empty string to omit the annotation.
## @param storage.annotations [object] Extra annotations for the PVC
##
storage:
  size: 1Gi
  storageClassName: ""
  accessMode: ReadWriteOnce
  resourcePolicy: keep
  annotations: {}

## @section Data directory

## @param dataPath Directory inside the container where the PVC is mounted. Config, vault, and runtime state live here.
##
dataPath: /nodectl/data

## @section Vault parameters
## Secrets vault configuration. Passed as VAULT_URL env var (required).
## Do NOT set vault in config.json — the service bails if both are set.
## Provide either vault.url (plain text) or vault.secretName (recommended).

## @param vault.url Vault URL (plain text). Examples: `file:///nodectl/data/vault.json&master_key=<hex>`, `hashicorp://<addr>?api_key=<token>&namespace=<ns>`
## @param vault.secretName Name of an existing Secret containing the vault URL. Takes precedence over vault.url.
## @param vault.secretKey Key inside the Secret that holds the vault URL.
##
vault:
  url: ""
  secretName: ""
  secretKey: "VAULT_URL"

## @section Initial config (optional)
## On first deploy the init container checks for config.json on the PVC:
## 1. Already exists → skip.
## 2. initConfig.secretName is set → copy from the Secret.
## 3. Otherwise → run `nodectl config generate`.

## @param initConfig.enabled Enable the init container that seeds config on first deploy
## @param initConfig.secretName [nullable] Name of the Secret containing initial config (key: config.json). Leave empty to auto-generate.
##
initConfig:
  enabled: true
  secretName: ""

## @section Security parameters

## @param securityContext [object] Security context for the nodectl container. Optionally add IPC_LOCK capability for file-based vault mlock() support.
##
securityContext: {}
# Example for mlock support:
#   securityContext:
#     capabilities:
#       add: ["IPC_LOCK"]

## @section Resource parameters

## @param resources.requests.cpu CPU request
## @param resources.requests.memory Memory request
## @param resources.limits.cpu CPU limit
## @param resources.limits.memory Memory limit
##
resources:
  requests:
    cpu: "100m"
    memory: 128Mi
  limits:
    cpu: "500m"
    memory: 256Mi

## @section Probe parameters
## nodectl exposes GET /health for health checks. Probes are enabled by default.

## @param probes [object] Liveness, readiness, and startup probes. Set to {} to disable all probes.
##
probes: {}

## @section Extra init containers

## @param extraInitContainers [array] Additional init containers to run before nodectl starts.
##
extraInitContainers: []

## @section Extra containers

## @param extraContainers [array] Additional sidecar containers to run alongside nodectl.
##
extraContainers: []

## @section Extra volumes

## @param extraVolumes [array] Additional volumes for the pod.
##
extraVolumes: []

## @param extraVolumeMounts [array] Additional volume mounts for the nodectl container.
##
extraVolumeMounts: []

## @section Extra environment variables

## @param extraEnv [array] Additional environment variables for the nodectl container.
##
extraEnv: []
# Example:
#   extraEnv:
#     - name: RUST_BACKTRACE
#       value: "1"

## @param extraEnvFrom [array] Additional envFrom sources for the nodectl container.
##
extraEnvFrom: []
# Example — inject vault token from a Secret:
#   extraEnvFrom:
#     - secretRef:
#         name: nodectl-vault-token

## @section Pod metadata parameters

## @param podAnnotations [object] Additional annotations for pods. Useful for Vault agent injection, service mesh, etc.
##
podAnnotations: {}

## @param podLabels [object] Additional labels for pods.
##
podLabels: {}

## @section Scheduling parameters

## @param nodeSelector [object] Node selector for pod scheduling
##
nodeSelector: {}

## @param tolerations [array] Tolerations for pod scheduling
##
tolerations: []

## @param affinity [object] Affinity rules for pod scheduling
##
affinity: {}

## @section ServiceAccount parameters

## @param serviceAccount.enabled Create a ServiceAccount for the pods
## @param serviceAccount.name [nullable] ServiceAccount name. Defaults to the release fullname if not set.
## @param serviceAccount.annotations [object] Annotations for the ServiceAccount (e.g. for Vault or cloud IAM role binding)
##
serviceAccount:
  enabled: false
  name: ""
  annotations: {}

## @section NetworkPolicy parameters

## @param networkPolicy.enabled Create a NetworkPolicy. Restricts ingress to the HTTP API port.
## @param networkPolicy.allowCIDRs [array] Source CIDRs allowed to reach the HTTP API. If empty, not restricted by source.
## @param networkPolicy.extraIngress [array] Additional raw ingress rules appended to the policy.
##
networkPolicy:
  enabled: false
  allowCIDRs: []
  extraIngress: []

## @section PodDisruptionBudget parameters

## @param podDisruptionBudget.enabled Create a PodDisruptionBudget
## @param podDisruptionBudget.minAvailable Minimum available pods during disruption. Only one of minAvailable or maxUnavailable should be set.
## @skip podDisruptionBudget.maxUnavailable
##
podDisruptionBudget:
  enabled: false
  minAvailable: 1
  # maxUnavailable: 1

## @section Debug parameters

## @param debug.sleep Replace nodectl with sleep infinity for debugging
## @param debug.securityContext [object] Security context overrides for debugging (e.g. SYS_PTRACE)
##
debug:
  sleep: false
  securityContext: {}
