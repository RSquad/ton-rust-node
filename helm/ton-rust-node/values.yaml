## @section General parameters

## @param replicas Number of node instances in the StatefulSet. Each replica is an independent TON node with its own config, keys, and IP — not replication for redundancy. You need a matching nodeConfigs entry (node-N.json) and a perReplica service entry for each replica.
##
replicas: 1

## @param command [array] Override container command. Auto-detected: adds `-z /main/static` when zerostate+basestate are provided. Change only if you know what you are doing.
##
command: []

## @section Image parameters

## @param image.repository Container image repository
## @param image.tag Image tag
## @param image.pullPolicy Pull policy
##
image:
  repository: ghcr.io/rsquad/ton-rust-node
  tag: v0.1.2-mainnet
  pullPolicy: IfNotPresent

## @section Init container image parameters

## @param initImage.repository Init container image repository
## @param initImage.tag Init container image tag
## @param initImage.pullPolicy Init container pull policy
##
initImage:
  repository: alpine
  tag: "3.21"
  pullPolicy: IfNotPresent

## @section Extra init containers

## @param extraInitContainers [array] Additional init containers to run before the node starts. Runs after the built-in init-bootstrap container. Useful for downloading global config, fetching external IP, etc.
##
extraInitContainers: []
# Example — download global config dynamically:
#   extraInitContainers:
#     - name: download-config
#       image: alpine/curl:latest
#       command:
#         - sh
#         - -c
#         - |
#           curl -sL https://ton.org/global-config.json -o /config/global.config.json
#       volumeMounts:
#         - name: main
#           mountPath: /config

## @section Extra containers

## @param extraContainers [array] Additional sidecar containers to run alongside the node. Useful for monitoring agents, log shippers, etc.
##
extraContainers: []

## @section Extra volumes

## @param extraVolumes [array] Additional volumes for the pod. Use with extraVolumeMounts to mount them into containers.
##
extraVolumes: []

## @param extraVolumeMounts [array] Additional volume mounts for the main node container.
##
extraVolumeMounts: []

## @section Resource parameters
## Defaults are for a fullnode/liteserver. For validators, use 16/32 CPU and 64Gi/128Gi.
## See docs/resources.md for details.

## @param resources.requests.cpu CPU request
## @param resources.requests.memory Memory request
## @param resources.limits.cpu CPU limit
## @param resources.limits.memory Memory limit
##
resources:
  requests:
    cpu: "8"
    memory: 32Gi
  limits:
    cpu: "16"
    memory: 64Gi

## @section Storage parameters
## IMPORTANT: The db volume requires up to 64k IOPS. Use NVMe/SSD with local storage.
## See README.md "Storage recommendations" for details.

## @param storage.main.size Main volume size
## @param storage.main.storageClassName Storage class for main volume
## @param storage.db.size Database volume size (hundreds of GB for mainnet)
## @param storage.db.storageClassName Storage class for database volume
## @param storage.logs.enabled Create a PVC for logs. Set to false if you log to stdout only.
## @param storage.logs.size Logs volume size
## @param storage.logs.storageClassName Storage class for logs volume
## @param storage.keys.size Keys volume size
## @param storage.keys.storageClassName Storage class for keys volume
##
storage:
  main:
    size: 1Gi
    storageClassName: local-path
  db:
    size: 1Ti
    storageClassName: local-path
  logs:
    enabled: true
    size: 150Gi
    storageClassName: local-path
  keys:
    size: 1Gi
    storageClassName: local-path

## @section Port parameters

## @param ports.adnl ADNL port (UDP)
## @param ports.control Control port (TCP). Set to null to disable.
## @param ports.liteserver [nullable] Liteserver port (TCP). Set to enable.
## @param ports.jsonRpc [nullable] JSON-RPC port (TCP). Set to enable.
## @param ports.metrics [nullable] Metrics/probes HTTP port (TCP). Serves /metrics, /healthz, /readyz. Set to enable.
##
ports:
  adnl: 30303
  control: 50000
  liteserver: null
  jsonRpc: null
  metrics: null

## @section Service parameters

## @param services.type Service type
## @param services.externalTrafficPolicy Traffic policy
## @param services.annotations [object] Annotations applied to ALL per-replica services
## @param services.perReplica [array] Per-replica service overrides. List index = replica index. Annotations are merged with the shared ones (per-replica wins on conflict).
##
services:
  type: LoadBalancer
  externalTrafficPolicy: Local
  annotations: {}
  perReplica: []
  # Example — MetalLB static IPs:
  #   perReplica:
  #     - annotations:
  #         metallb.universe.tf/loadBalancerIPs: "192.168.1.100"
  #     - annotations:
  #         metallb.universe.tf/loadBalancerIPs: "192.168.1.101"
  #
  # Example — AWS Elastic IPs:
  #   perReplica:
  #     - annotations:
  #         service.beta.kubernetes.io/aws-load-balancer-eip-allocations: "eipalloc-aaa"
  #     - annotations:
  #         service.beta.kubernetes.io/aws-load-balancer-eip-allocations: "eipalloc-bbb"
  #
  # Example — GCP static IPs:
  #   perReplica:
  #     - annotations:
  #         networking.gke.io/load-balancer-ip-addresses: "my-ip-ref-0"
  #     - annotations:
  #         networking.gke.io/load-balancer-ip-addresses: "my-ip-ref-1"

## @section Configuration parameters

## @param nodeConfigs [object] Per-node JSON configs (one node-N.json per replica). See docs/node-config.md.
## @param existingNodeConfigsSecretName Use an existing Secret for node configs instead of inline
##
nodeConfigs: {}
# Example:
#   node-0.json: |
#     { "log_config_name": "/main/logs.config.yml", ... }
existingNodeConfigsSecretName: ""

## @param globalConfig [default: bundled mainnet] Global TON network config (JSON string). A mainnet default is bundled in files/global.config.json. See docs/global-config.md.
## @param existingGlobalConfigMapName Use an existing ConfigMap for global config instead of inline
##
globalConfig: ""
existingGlobalConfigMapName: ""

## @param logsConfig [default: bundled default] Logging configuration (log4rs YAML). A default is bundled in files/logs.config.yml. See docs/logging.md.
## @param existingLogsConfigMapName Use an existing ConfigMap for logs config instead of inline
##
logsConfig: ""
existingLogsConfigMapName: ""

## @param basestate Base64-encoded basestate.boc. Only needed when bootstrapping a brand new network.
## @param existingBasestateConfigMapName Use an existing ConfigMap for basestate
## @param zerostate Base64-encoded zerostate.boc. Only needed when bootstrapping a brand new network.
## @param existingZerostateConfigMapName Use an existing ConfigMap for zerostate
##
basestate: ""
existingBasestateConfigMapName: ""
zerostate: ""
existingZerostateConfigMapName: ""

## @section Probe parameters

## @param probes [object] Liveness, readiness, and startup probes. Requires ports.metrics to be set (the node serves /healthz and /readyz on the metrics port). See docs/probes.md. Disabled by default.
##
probes: {}
# Example (requires ports.metrics to be set):
#   startup:
#     httpGet:
#       path: /healthz
#       port: metrics
#     failureThreshold: 60
#     periodSeconds: 10
#   liveness:
#     httpGet:
#       path: /healthz
#       port: metrics
#     periodSeconds: 30
#     failureThreshold: 3
#   readiness:
#     httpGet:
#       path: /readyz
#       port: metrics
#     periodSeconds: 10
#     failureThreshold: 3

## @section Pod metadata parameters

## @param podAnnotations [object] Additional annotations for pods. Useful for Vault agent injection, service mesh, etc.
##
podAnnotations: {}

## @param podLabels [object] Additional labels for pods. Useful for cost allocation, policy enforcement, etc.
##
podLabels: {}

## @section Extra environment variables

## @param extraEnv [array] Additional environment variables for the main node container. Supports Downward API, ConfigMap/Secret refs, etc.
##
extraEnv: []
# Example — Kubernetes Downward API:
#   extraEnv:
#     - name: K8S_NODE_IP
#       valueFrom:
#         fieldRef:
#           fieldPath: status.hostIP
#     - name: K8S_POD_NAME
#       valueFrom:
#         fieldRef:
#           fieldPath: metadata.name

## @param extraEnvFrom [array] Additional envFrom sources for the main node container. Inject all keys from a Secret or ConfigMap as environment variables.
##
extraEnvFrom: []
# Example — inject all keys from a Secret:
#   extraEnvFrom:
#     - secretRef:
#         name: my-node-secrets

## @section Networking parameters

## @param hostNetwork Bind pods directly to the host network. The pod gets the node's IP with zero NAT overhead. Requires one pod per node — use nodeSelector or podAntiAffinity to spread replicas. See docs/networking.md.
##
hostNetwork: false

## @param hostPort.enabled Expose the ADNL port on the host IP via hostPort. A lighter alternative to hostNetwork — only the ADNL UDP port is bound to the host, network policies still work. See docs/networking.md.
##
hostPort:
  enabled: false
# Example — expose ADNL on the host without hostNetwork.
# Anti-affinity is required: two pods on the same node would compete for the same host port.
#   hostPort:
#     enabled: true
#   affinity:
#     podAntiAffinity:
#       requiredDuringSchedulingIgnoredDuringExecution:
#         - labelSelector:
#             matchLabels:
#               app.kubernetes.io/name: ton-rust-node
#           topologyKey: kubernetes.io/hostname

## @section NetworkPolicy parameters

## @param networkPolicy.enabled Create a NetworkPolicy. ADNL is always allowed from 0.0.0.0/0. TCP ports (control, liteserver, jsonRpc, metrics) get rules automatically when enabled — restrict with allowCIDRs.
## @param networkPolicy.allowCIDRs [array] Source CIDRs for TCP port rules (control, liteserver, jsonRpc, metrics). Defaults to cluster-only if empty.
## @param networkPolicy.extraIngress [array] Additional raw ingress rules appended to the policy.
##
networkPolicy:
  enabled: false
  allowCIDRs: []
  extraIngress: []
# Example — restrict TCP ports to internal network, add a custom rule:
#   networkPolicy:
#     enabled: true
#     allowCIDRs:
#       - 10.0.0.0/8
#     extraIngress:
#       - ports:
#           - port: 8080
#             protocol: TCP
#         from:
#           - namespaceSelector:
#               matchLabels:
#                 name: monitoring

## @section ServiceAccount parameters

## @param serviceAccount.enabled Create a ServiceAccount for the pods
## @param serviceAccount.name [nullable] ServiceAccount name. Defaults to the release fullname if not set.
## @param serviceAccount.annotations [object] Annotations for the ServiceAccount (e.g. for Vault or cloud IAM role binding)
##
serviceAccount:
  enabled: false
  name: ""
  annotations: {}

## @section Scheduling parameters

## @param nodeSelector [object] Node selector for pod scheduling
##
nodeSelector: {}
# Example:
#   nodeSelector:
#     dedicated: ton-nodes

## @param tolerations [array] Tolerations for pod scheduling
##
tolerations: []
# Example:
#   tolerations:
#     - key: dedicated
#       value: ton
#       effect: NoSchedule

## @param affinity [object] Affinity rules for pod scheduling
##
affinity: {}
# Example:
#   affinity:
#     podAntiAffinity:
#       requiredDuringSchedulingIgnoredDuringExecution:
#         - labelSelector:
#             matchLabels:
#               app.kubernetes.io/name: ton-rust-node
#           topologyKey: kubernetes.io/hostname

## @section PodDisruptionBudget parameters
## Useful when replicas > 1 to prevent Kubernetes from evicting all pods at once
## during voluntary disruptions (node drain, cluster upgrades, etc.).

## @param podDisruptionBudget.enabled Create a PodDisruptionBudget
## @param podDisruptionBudget.minAvailable Minimum available pods during disruption. Only one of minAvailable or maxUnavailable should be set.
## @skip podDisruptionBudget.maxUnavailable
##
podDisruptionBudget:
  enabled: false
  minAvailable: 1
  # maxUnavailable: 1

## @section Debug parameters

## @param debug.sleep Replace node with sleep infinity for debugging
## @param debug.securityContext [object] Security context overrides for debugging (e.g. SYS_PTRACE)
##
debug:
  sleep: false
  securityContext: {}

## @section Metrics parameters
## Prometheus integration for metrics scraping. Requires ports.metrics to be set.
## See docs/monitoring.md for setup instructions.

## @param metrics.serviceMonitor.enabled Create a ServiceMonitor for kube-prometheus-stack (recommended)
## @param metrics.serviceMonitor.namespace [nullable] Namespace for ServiceMonitor (defaults to release namespace)
## @param metrics.serviceMonitor.interval [nullable] Scrape interval (e.g. "30s"). Uses Prometheus default if null.
## @param metrics.serviceMonitor.scrapeTimeout [nullable] Scrape timeout. Uses Prometheus default if null.
## @param metrics.serviceMonitor.labels [object] Extra labels for ServiceMonitor (for Prometheus selector matching)
## @param metrics.annotations.enabled Add prometheus.io annotations to the metrics ClusterIP service (alternative to ServiceMonitor)
##
metrics:
  serviceMonitor:
    enabled: false
    namespace: null
    interval: null
    scrapeTimeout: null
    labels: {}
  annotations:
    enabled: false
